import streamlit as st
import pandas as pd
from datetime import datetime

# ===============================
# ğŸ‰ Streamlit App Config
# ===============================
st.set_page_config(
    page_title="ğŸ“âœ¨ MBTI ì§„ë¡œêµìœ¡ ì›”ë“œ",
    page_icon="ğŸ§­",
    layout="wide",
    initial_sidebar_state="expanded",
)

# ===============================
# ğŸŒˆ Custom CSS (í™”ë ¤í•¨ MAX)
# ===============================
st.markdown(
    """
    <style>
        .stApp {
            background: linear-gradient(135deg, #FFE3F1 0%, #E3F0FF 50%, #E9FFE3 100%);
            background-attachment: fixed;
        }
        /* ì¹´ë“œ ëŠë‚Œ */
        .glass {
            background: rgba(255,255,255,0.65);
            backdrop-filter: blur(12px);
            border-radius: 24px;
            padding: 18px 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.6);
        }
        /* í—¤ë” íƒ€ì´í‹€ ë°˜ì§ì„ */
        .shiny {
            background: linear-gradient(90deg, #ff4d4d, #ff9f1c, #2ec4b6, #6a4c93);
            -webkit-background-clip: text;  background-clip: text;
            color: transparent;
            animation: glow 6s ease-in-out infinite;
            font-weight: 900;
        }
        @keyframes glow {
            0% { text-shadow: 0 0 10px rgba(255, 77, 77, .5); }
            50% { text-shadow: 0 0 18px rgba(46, 196, 182, .6); }
            100% { text-shadow: 0 0 10px rgba(106, 76, 147, .5); }
        }
        /* ë°°ì§€ */
        .badge { display:inline-block; padding:6px 12px; border-radius:20px; font-size:0.85rem; font-weight:700; }
        .badge-pink { background:#ffd6e7; color:#b8005c; }
        .badge-blue { background:#d6ebff; color:#0052cc; }
        .badge-green{ background:#dcffe4; color:#007f3b; }
        .emoji-splash { font-size: 1.4rem; }
        .hr-soft { border:0; height:1px; background:linear-gradient(90deg, transparent, rgba(0,0,0,0.15), transparent); margin:16px 0 6px; }
        .subtle { color:#444; }
        /* ì‚¬ì´ë“œë°” ì œëª© ê¾¸ë¯¸ê¸° */
        section[data-testid="stSidebar"] .css-1d391kg, section[data-testid="stSidebar"] h1, section[data-testid="stSidebar"] h2 {
            color:#1f2937 !important;
        }
    </style>
    """,
    unsafe_allow_html=True,
)

# ===============================
# ğŸ§  ë°ì´í„°ë² ì´ìŠ¤ (MBTI 16ìœ í˜•)
# ===============================
MBTI_DB = {
    "INTJ": {"íŠ¹ì§•":"ì „ëµê°€ Â· ë…ë¦½ì  Â· ì¥ê¸°ê³„íš", "ì¶”ì²œì§„ë¡œ":["ë°ì´í„°ê³¼í•™ì","ì „ëµê¸°íš","ì‹œìŠ¤í…œì—”ì§€ë‹ˆì–´","UXë¦¬ì„œì²˜"], "ì „ê³µ":["ì»´í“¨í„°ê³µí•™","ì‚°ì—…ê³µí•™","ê²½ì˜í•™","ìˆ˜í•™"], "í•™ìŠµíŒ":"ëª©í‘œë¥¼ ì„¸ë¶€ ë‹¨ê³„ë¡œ ë¶„í•´í•˜ê³ , ë”¥ì›Œí¬ ì‹œê°„ í™•ë³´ â³"},
    "INTP": {"íŠ¹ì§•":"ë¶„ì„ì  Â· í˜¸ê¸°ì‹¬ Â· ì•„ì´ë””ì–´ í’ë¶€", "ì¶”ì²œì§„ë¡œ":["ì—°êµ¬ì›","ê°œë°œì","êµìˆ˜","ë°ì´í„°ë¶„ì„ê°€"], "ì „ê³µ":["ë¬¼ë¦¬","ìˆ˜í•™","ì»´ê³µ","ì¸ì§€ê³¼í•™"], "í•™ìŠµíŒ":"ë¬¸ì œë¥¼ ëª¨ë¸ë§í•˜ê³  ê°€ì„¤-ê²€ì¦ ë£¨í”„ ë°˜ë³µ ğŸ”"},
    "ENTJ": {"íŠ¹ì§•":"ë¦¬ë”ì‹­ Â· ì²´ê³„í™” Â· ëª©í‘œì§€í–¥", "ì¶”ì²œì§„ë¡œ":["í”„ë¡œë•íŠ¸ë§¤ë‹ˆì €","ì»¨ì„¤í„´íŠ¸","ì°½ì—…","ì „ëµê°€"], "ì „ê³µ":["ê²½ì˜","ê²½ì œ","ì‚°ì—…ê³µí•™","ì •ì¹˜"], "í•™ìŠµíŒ":"OKRë¡œ ìš°ì„ ìˆœìœ„ ê´€ë¦¬, ë°œí‘œë¡œ ì´í•´ ê³µê³ í™” ğŸ¤"},
    "ENTP": {"íŠ¹ì§•":"í† ë¡ ê°€ Â· í˜ì‹  Â· ìœ ì—°", "ì¶”ì²œì§„ë¡œ":["ì°½ì—…ê°€","ë§ˆì¼€íŒ…ì „ëµ","VC/ìŠ¤íƒ€íŠ¸ì—…","UXê¸°íš"], "ì „ê³µ":["ê²½ì˜","ë””ìì¸","ë¯¸ë””ì–´","ì»´ê³µ"], "í•™ìŠµíŒ":"ë¸Œë ˆì¸ìŠ¤í† ë° â†’ í”„ë¡œí† íƒ€ì… â†’ í”¼ë“œë°± ì‚¬ì´í´ âš™ï¸"},
    "INFJ": {"íŠ¹ì§•":"í†µì°° Â· ê°€ì¹˜ì§€í–¥ Â· ì¡°í™”", "ì¶”ì²œì§„ë¡œ":["ìƒë‹´ì‚¬","êµìœ¡ê¸°íš","ë¸Œëœë“œì „ëµ","ì½˜í…ì¸ ê¸°íš"], "ì „ê³µ":["ì‹¬ë¦¬","êµìœ¡","ì² í•™","ë¬¸í—Œì •ë³´"], "í•™ìŠµíŒ":"ë¹„ì „ ë³´ë“œë¡œ ì¥ê¸° ì˜ë¯¸ì™€ ì˜¤ëŠ˜ í•  ì¼ ì—°ê²° ğŸ¯"},
    "INFP": {"íŠ¹ì§•":"ì´ìƒê°€ Â· ê³µê° Â· ì°½ì˜í‘œí˜„", "ì¶”ì²œì§„ë¡œ":["ì‘ê°€","ë””ìì´ë„ˆ","ì˜ìƒê¸°íš","ì‚¬íšŒë³µì§€"], "ì „ê³µ":["ë¬¸ì˜ˆì°½ì‘","ë””ìì¸","ë¯¸ë””ì–´","ì‚¬íšŒë³µì§€"], "í•™ìŠµíŒ":"ì €ë„ë§ìœ¼ë¡œ ê°€ì¹˜ì™€ í”„ë¡œì íŠ¸ ì •ë ¬ âœï¸"},
    "ENFJ": {"íŠ¹ì§•":"ì½”ì¹˜ Â· í˜‘ì—… Â· ì˜ê°ë¶€ì—¬", "ì¶”ì²œì§„ë¡œ":["êµìœ¡ì","HRD","ì»¤ë®¤ë‹ˆí‹°ë§¤ë‹ˆì €","PR"], "ì „ê³µ":["êµìœ¡","ê²½ì˜","ì»¤ë®¤ë‹ˆì¼€ì´ì…˜","ì‚¬íšŒ"], "í•™ìŠµíŒ":"ìŠ¤í„°ë”” ë¦¬ë“œ, í”¼ì–´ëŸ¬ë‹ ì„¤ê³„ ğŸ¤"},
    "ENFP": {"íŠ¹ì§•":"í™œê¸° Â· ì—°ê²° Â· ì•„ì´ë””ì–´", "ì¶”ì²œì§„ë¡œ":["í¬ë¦¬ì—ì´í„°","ê¸°íšì","ë¸Œëœë“œë§ˆì¼€í„°","ì—ë°˜ì ¤ë¦¬ìŠ¤íŠ¸"], "ì „ê³µ":["ê´‘ê³ í™ë³´","ë¯¸ë””ì–´","ë””ìì¸","ê²½ì˜"], "í•™ìŠµíŒ":"ë‹¤ì–‘í•œ ì‹œë„ë¥¼ ìº¡ì²˜í•˜ëŠ” ì•„ì´ë””ì–´ ì¸ë°•ìŠ¤ ğŸ“®"},
    "ISTJ": {"íŠ¹ì§•":"ì‹ ë¢°ì„± Â· ê¼¼ê¼¼í•¨ Â· ê·œë²”", "ì¶”ì²œì§„ë¡œ":["íšŒê³„","ê³µë¬´","í’ˆì§ˆê´€ë¦¬","ë°ì´í„°ê´€ë¦¬"], "ì „ê³µ":["íšŒê³„","í–‰ì •","í†µê³„","ë²•"], "í•™ìŠµíŒ":"ì²´í¬ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ìŠµê´€í™” âœ…"},
    "ISFJ": {"íŠ¹ì§•":"í—Œì‹  Â· ì•ˆì • Â· ì„¸ì‹¬", "ì¶”ì²œì§„ë¡œ":["ê°„í˜¸","êµì§","CSì „ë¬¸ê°€","ìš´ì˜"], "ì „ê³µ":["ê°„í˜¸","êµìœ¡","ê²½ì˜ì§€ì›","í–‰ì •"], "í•™ìŠµíŒ":"ì•”ê¸°+ì‚¬ë¡€ ì—°ê²°ë¡œ ì‹¤ì „ê°ê° ìƒìŠ¹ ğŸ§©"},
    "ESTJ": {"íŠ¹ì§•":"ì‹¤í–‰ë ¥ Â· ì¡°ì§í™” Â· í˜„ì‹¤ì£¼ì˜", "ì¶”ì²œì§„ë¡œ":["í”„ë¡œì íŠ¸ë§¤ë‹ˆì €","ìš´ì˜ê´€ë¦¬","ì„¸ë¬´","ì˜ì—…ë¦¬ë”"], "ì „ê³µ":["ê²½ì˜","ë¬¼ë¥˜","íšŒê³„","ë²•"], "í•™ìŠµíŒ":"ê°„íŠ¸ì°¨íŠ¸/ìº˜ë¦°ë”ë¡œ ì¼ì • ì—„ìˆ˜ ğŸ“…"},
    "ESFJ": {"íŠ¹ì§•":"ì‚¬êµ Â· ë°°ë ¤ Â· ì±…ì„", "ì¶”ì²œì§„ë¡œ":["êµì‚¬","ê°„í˜¸ì‚¬","ì‚¬íšŒë³µì§€","ì¸ì‚¬"], "ì „ê³µ":["êµìœ¡","ë³´ê±´","ì‚¬íšŒë³µì§€","HR"], "í•™ìŠµíŒ":"íŒ€ ê¸°ë°˜ í•™ìŠµê³¼ ì—­í•  ë¶„ë‹´ ìµœì í™” ğŸ‘¥"},
    "ISTP": {"íŠ¹ì§•":"ë¬¸ì œí•´ê²° Â· ì‹¤í—˜ Â· ëƒ‰ì² ", "ì¶”ì²œì§„ë¡œ":["ì—”ì§€ë‹ˆì–´","ë³´ì•ˆ","íŒŒì¼ëŸ¿","í”„ë¡œí† íƒ€ì…"], "ì „ê³µ":["ê¸°ê³„","ì „ê¸°","ì»´ê³µ","í•­ê³µ"], "í•™ìŠµíŒ":"ì†ìœ¼ë¡œ ë§Œë“œëŠ” Tinkering, ë¡œê·¸ ê¸°ë¡ ğŸ”§"},
    "ISFP": {"íŠ¹ì§•":"ê°ì„±ì‹¤ìš© Â· ë¯¸ì ê°ê° Â· ìœ ì—°", "ì¶”ì²œì§„ë¡œ":["ë””ìì´ë„ˆ","í¬í† /ì˜ìƒ","UX","í•¸ë“œí¬ë˜í”„íŠ¸"], "ì „ê³µ":["ì‹œê°ë””ìì¸","ê³µì˜ˆ","ë¯¸ë””ì–´","íŒ¨ì…˜"], "í•™ìŠµíŒ":"ë¬´ë“œë³´ë“œÂ·ë ˆí¼ëŸ°ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ ğŸ¨"},
    "ESTP": {"íŠ¹ì§•":"ì•¡ì…˜ Â· í˜„ì‹¤ê°ê° Â· ì„¤ë“", "ì¶”ì²œì§„ë¡œ":["ì„¸ì¼ì¦ˆ","ì´ë²¤íŠ¸","ìŠ¤í¬ì¸ ë§¤ë‹ˆì§€ë¨¼íŠ¸","íŠ¸ë ˆì´ë”"], "ì „ê³µ":["ë§ˆì¼€íŒ…","ê²½ì˜","ì²´ìœ¡","ê²½ì œ"], "í•™ìŠµíŒ":"ì¼€ì´ìŠ¤ ìŠ¤í„°ë””ì™€ í˜„ì¥í•™ìŠµ ğŸ“Š"},
    "ESFP": {"íŠ¹ì§•":"ì—ë„ˆì§€ Â· ì–´ìš¸ë¦¼ Â· ì¦‰í¥", "ì¶”ì²œì§„ë¡œ":["MC/í¬ë¦¬ì—ì´í„°","í˜¸í…”/ê´€ê´‘","ê³µì—°ì˜ˆìˆ ","í™ë³´"], "ì „ê³µ":["ê´€ê´‘","ê³µì—°","ë¯¸ë””ì–´","ì»¤ë®¤ë‹ˆì¼€ì´ì…˜"], "í•™ìŠµíŒ":"ì§§ì€ ìŠ¤í”„ë¦°íŠ¸ í•™ìŠµ + í˜„ì¥ ë°œí‘œ ğŸ‰"},
}

# ===============================
# ğŸ”§ ìœ í‹¸ í•¨ìˆ˜
# ===============================
DICHOTOMIES = [
    ("E", "I"),
    ("S", "N"),
    ("T", "F"),
    ("J", "P"),
]

QUIZ = [
    ("ì‚¬ëŒ ë§ì€ ê³³ì—ì„œ ì—ë„ˆì§€ ì¶©ì „ âœ¨", "ì¡°ìš©í•œ í˜¼ì ì‹œê°„ì—ì„œ ì¬ì¶©ì „ ğŸŒ™", "E", "I"),
    ("í˜„ì¬ì˜ ì‚¬ì‹¤Â·ë””í…Œì¼ì— ê°•í•¨ ğŸ”", "ë¯¸ë˜ ê°€ëŠ¥ì„±Â·ì§ê´€ì— ëŒë¦¼ ğŸŒˆ", "S", "N"),
    ("ë…¼ë¦¬Â·ì›ì¹™ìœ¼ë¡œ íŒë‹¨ âš–ï¸", "ì‚¬ëŒÂ·ê°€ì¹˜ë¡œ íŒë‹¨ ğŸ’", "T", "F"),
    ("ê³„íší‘œ ì¢‹ì•„í•¨ ğŸ“…", "ì¦‰í¥ë„ í™˜ì˜ ğŸ²", "J", "P"),
    ("ì¡ë‹´ë³´ë‹¤ í™œë™! ğŸƒ", "í™œë™ë³´ë‹¤ ê¹Šì€ ëŒ€í™” ğŸ§ ", "E", "I"),
    ("ê²½í—˜Â·ì‚¬ë¡€ ì¤‘ìš” ğŸ§­", "ì•„ì´ë””ì–´Â·ì´ë¡  ì¤‘ìš” ğŸ§ª", "S", "N"),
    ("ì§ì„¤Â·íŒ©íŠ¸ ì„ í˜¸ ğŸ§Š", "ë°°ë ¤Â·ë¶„ìœ„ê¸° ì¤‘ì‹œ ğŸŒ¤", "T", "F"),
    ("ë§ˆê° ì „ ì—¬ìœ  ìˆê²Œ â°", "ë°ë“œë¼ì¸ ìŠ¤ë¦´ âœ¨", "J", "P"),
]

@st.cache_data
def empty_results():
    return {"E":0, "I":0, "S":0, "N":0, "T":0, "F":0, "J":0, "P":0}

# ===============================
# ğŸ§­ ì‚¬ì´ë“œë°” (ë„¤ë¹„ê²Œì´ì…˜)
# ===============================
with st.sidebar:
    st.markdown("## ğŸ§­ ë„¤ë¹„ê²Œì´ì…˜")
    page = st.radio(
        "ì´ë™í•  í˜ì´ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”",
        ["ğŸ  í™ˆ", "ğŸ“ MBTI í€´ì¦ˆ", "ğŸ” ê²°ê³¼ & ì¶”ì²œ", "ğŸŒ ìœ í˜• íƒìƒ‰", "ğŸ“š ë¦¬ì†ŒìŠ¤"],
        index=0,
    )
    st.markdown("<hr class='hr-soft' />", unsafe_allow_html=True)
    st.markdown(
        f"<span class='badge badge-blue'>ì˜¤ëŠ˜: {datetime.now().strftime('%Y-%m-%d')}</span>",
        unsafe_allow_html=True,
    )
    st.markdown("<span class='subtle'>Tips: ê²°ê³¼ í˜ì´ì§€ì—ì„œ ğŸŠ ì´ë²¤íŠ¸ê°€ ìˆì–´ìš”!</span>", unsafe_allow_html=True)

# ===============================
# ğŸ  í™ˆ
# ===============================
if page == "ğŸ  í™ˆ":
    st.markdown("""
    <h1 class='shiny'>ğŸ“ MBTI ê¸°ë°˜ ì§„ë¡œêµìœ¡ ì›”ë“œ ğŸŒŸ</h1>
    <div class='emoji-splash'>ğŸ§ ğŸ’¼âœ¨ğŸ¨ğŸ›°ï¸ğŸ“šğŸ§­ğŸš€ğŸ’¡ğŸ¯</div>
    <p class='subtle'>ë‹¹ì‹ ì˜ ì„±ê²©ìœ í˜•ì— ê¼­ ë§ëŠ” ì „ê³µÂ·ì§ì—…Â·í•™ìŠµì „ëµì„ ì°¾ì•„ë³´ì„¸ìš”!</p>
    """, unsafe_allow_html=True)

    c1, c2, c3 = st.columns([1.2,1,1])
    with c1:
        st.markdown("""
        <div class='glass'>
            <h3>ğŸ—º ë¬´ì—‡ì„ í•  ìˆ˜ ìˆë‚˜ìš”?</h3>
            <ul>
                <li>ğŸ“ 1ë¶„ í€´ì¦ˆë¡œ MBTI ê²½í–¥ íŒŒì•…</li>
                <li>ğŸ¯ ìœ í˜•ë³„ ì „ê³µÂ·ì§ì—… ì¶”ì²œ</li>
                <li>ğŸ“ˆ ê°•ì  ê¸°ë°˜ í•™ìŠµì „ëµ ì œì•ˆ</li>
                <li>ğŸ” 16ìœ í˜• ë¹„êµÂ·íƒìƒ‰</li>
            </ul>
        </div>
        """, unsafe_allow_html=True)
    with c2:
        st.markdown("""
        <div class='glass'>
            <h3>âœ¨ ë¹ ë¥¸ ì‹œì‘</h3>
            <p>ì¢Œì¸¡ <b>ğŸ“ MBTI í€´ì¦ˆ</b>ë¡œ ì´ë™í•˜ê±°ë‚˜, ì§ì ‘ ìœ í˜•ì„ ì„ íƒí•´ ë³´ì„¸ìš”!</p>
            <p><span class='badge badge-pink'>Tip</span> ê²°ê³¼ í˜ì´ì§€ì—ì„œ ê·¸ë˜í”„ì™€ ì¹´ë“œê°€ ìë™ ìƒì„±ë¼ìš”.</p>
        </div>
        """, unsafe_allow_html=True)
    with c3:
        st.markdown("""
        <div class='glass'>
            <h3>ğŸ§© 16ìœ í˜• ìš”ì•½</h3>
            <p>ë¶„ì„ê°€(ğŸ‘“)Â·ì™¸êµê´€(ğŸ•Š)Â·ê´€ë¦¬ì(ğŸ—‚)Â·íƒí—˜ê°€(ğŸ§­) 4ê·¸ë£¹ìœ¼ë¡œ ì‚´í´ë³´ì„¸ìš”.</p>
        </div>
        """, unsafe_allow_html=True)

# ===============================
# ğŸ“ MBTI í€´ì¦ˆ
# ===============================
if page == "ğŸ“ MBTI í€´ì¦ˆ":
    st.markdown("<h2>ğŸ“ ì´ˆê°„ë‹¨ MBTI ê²½í–¥ í€´ì¦ˆ</h2>", unsafe_allow_html=True)
    st.markdown("<div class='glass'>ì„ í˜¸í•˜ëŠ” ë¬¸ì¥ì„ ì„ íƒí•˜ì„¸ìš”. (ì´ %d ë¬¸í•­)</div>" % len(QUIZ), unsafe_allow_html=True)

    if "quiz_scores" not in st.session_state:
        st.session_state.quiz_scores = empty_results()
        st.session_state.answers = [None]*len(QUIZ)

    for i, (a_text, b_text, a_code, b_code) in enumerate(QUIZ, start=1):
        st.markdown(f"<hr class='hr-soft' />", unsafe_allow_html=True)
        st.markdown(f"**Q{i}.** {a_text} **vs** {b_text}")
        choice = st.radio(
            label=f"q{i}",
            options=[a_text, b_text],
            horizontal=True,
            index=0 if st.session_state.answers[i-1] == a_text else (1 if st.session_state.answers[i-1] == b_text else 0),
            key=f"radio_{i}",
        )
        st.session_state.answers[i-1] = choice
        if choice == a_text:
            st.session_state.quiz_scores[a_code] += 1
        else:
            st.session_state.quiz_scores[b_code] += 1

    st.markdown("<hr class='hr-soft' />", unsafe_allow_html=True)
    if st.button("ğŸ¯ ê²°ê³¼ ë³´ëŸ¬ê°€ê¸° (ìë™ ê³„ì‚°)"):
        st.session_state["go_result"] = True
        st.switch_page("streamlit_app.py") if False else None  # placeholder for multipage
        st.success("ì¢Œì¸¡ 'ğŸ” ê²°ê³¼ & ì¶”ì²œ' í˜ì´ì§€ë¡œ ì´ë™í•´ ì£¼ì„¸ìš”! ğŸš€")

# ===============================
# ğŸ” ê²°ê³¼ & ì¶”ì²œ
# ===============================
if page == "ğŸ” ê²°ê³¼ & ì¶”ì²œ":
    st.markdown("<h2>ğŸ” ê²°ê³¼ & ë§ì¶¤ ì¶”ì²œ</h2>", unsafe_allow_html=True)

    # ìˆ˜ë™ ì…ë ¥ + ë“œë¡­ë‹¤ìš´
    col1, col2 = st.columns([1,2])
    with col1:
        manual = st.text_input("ğŸ“¥ MBTI ì§ì ‘ ì…ë ¥ (ì˜ˆ: INFP)").upper().strip()
        selected = st.selectbox("ë˜ëŠ” ëª©ë¡ì—ì„œ ì„ íƒ", sorted(list(MBTI_DB.keys())))
        final_type = manual if manual in MBTI_DB else selected
        st.markdown(f"<span class='badge badge-green'>ì„ íƒëœ ìœ í˜•: {final_type}</span>", unsafe_allow_html=True)
    with col2:
        # í€´ì¦ˆ ìŠ¤ì½”ì–´ ì‹œê°í™”
        scores = st.session_state.get("quiz_scores", empty_results())
        df = (
            pd.DataFrame([
                {"ì¶•":"E vs I", "E": scores["E"], "I": scores["I"]},
                {"ì¶•":"S vs N", "S": scores["S"], "N": scores["N"]},
                {"ì¶•":"T vs F", "T": scores["T"], "F": scores["F"]},
                {"ì¶•":"J vs P", "J": scores["J"], "P": scores["P"]},
            ]).set_index("ì¶•")
        )
        st.markdown("<div class='glass'>ğŸ“Š í€´ì¦ˆ ê²½í–¥ ê·¸ë˜í”„</div>", unsafe_allow_html=True)
        st.bar_chart(df)

    # ì¶”ì²œ ì¹´ë“œ
    data = MBTI_DB[final_type]
    c1, c2, c3 = st.columns(3)
    with c1:
        st.markdown(f"""
        <div class='glass'>
            <h3>ğŸ§  íŠ¹ì§•</h3>
            <p>{data['íŠ¹ì§•']}</p>
        </div>
        """, unsafe_allow_html=True)
    with c2:
        st.markdown(f"""
        <div class='glass'>
            <h3>ğŸ¯ ì¶”ì²œ ì§„ë¡œ</h3>
            <p>{' Â· '.join(data['ì¶”ì²œì§„ë¡œ'])}</p>
        </div>
        """, unsafe_allow_html=True)
    with c3:
        st.markdown(f"""
        <div class='glass'>
            <h3>ğŸ“ ì¶”ì²œ ì „ê³µ</h3>
            <p>{' Â· '.join(data['ì „ê³µ'])}</p>
        </div>
        """, unsafe_allow_html=True)

    st.markdown(f"""
    <div class='glass'>
        <h3>ğŸ“š í•™ìŠµ ì „ëµ</h3>
        <p>{data['í•™ìŠµíŒ']}</p>
    </div>
    """, unsafe_allow_html=True)

    st.balloons()

# ===============================
# ğŸŒ ìœ í˜• íƒìƒ‰
# ===============================
if page == "ğŸŒ ìœ í˜• íƒìƒ‰":
    st.markdown("<h2>ğŸŒ 16ìœ í˜• í•œëˆˆì— ë³´ê¸°</h2>", unsafe_allow_html=True)
    group_tabs = st.tabs(["ğŸ‘“ ë¶„ì„ê°€ (NT)", "ğŸ•Š ì™¸êµê´€ (NF)", "ğŸ—‚ ê´€ë¦¬ì (SJ)", "ğŸ§­ íƒí—˜ê°€ (SP)"])

    groups = {
        "ğŸ‘“ ë¶„ì„ê°€ (NT)": ["INTJ","INTP","ENTJ","ENTP"],
        "ğŸ•Š ì™¸êµê´€ (NF)": ["INFJ","INFP","ENFJ","ENFP"],
        "ğŸ—‚ ê´€ë¦¬ì (SJ)": ["ISTJ","ISFJ","ESTJ","ESFJ"],
        "ğŸ§­ íƒí—˜ê°€ (SP)": ["ISTP","ISFP","ESTP","ESFP"],
    }

    for tab, key in zip(group_tabs, groups.keys()):
        with tab:
            cols = st.columns(4)
            for i, t in enumerate(groups[key]):
                with cols[i % 4]:
                    card = MBTI_DB[t]
                    st.markdown(f"""
                    <div class='glass'>
                        <h4>{t} âœ¨</h4>
                        <div class='subtle'>ğŸ§  {card['íŠ¹ì§•']}</div>
                        <hr class='hr-soft'/>
                        <div>ğŸ¯ {' â€¢ '.join(card['ì¶”ì²œì§„ë¡œ'][:3])}</div>
                        <div>ğŸ“ {' â€¢ '.join(card['ì „ê³µ'][:3])}</div>
                    </div>
                    """, unsafe_allow_html=True)

# ===============================
# ğŸ“š ë¦¬ì†ŒìŠ¤
# ===============================
if page == "ğŸ“š ë¦¬ì†ŒìŠ¤":
    st.markdown("<h2>ğŸ“š ì§„ë¡œ ì„¤ê³„ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>", unsafe_allow_html=True)
    with st.expander("ğŸ§­ ë‚˜ë§Œì˜ ì»¤ë¦¬ì–´ ë‚˜ì¹¨ë°˜ ë§Œë“¤ê¸°"):
        st.markdown("""
        - ğŸ§© ê°•ì  3ê°€ì§€ ì ê¸° â†’ MBTI ì„¤ëª…ê³¼ ë§¤ì¹­
        - ğŸ¯ 1ë…„/3ë…„ ëª©í‘œ ì •ì˜ (ì„±ê³¼ì§€í‘œ í¬í•¨)
        - ğŸ—º ì „ê³µ ê³¼ëª©/í™œë™ ë¡œë“œë§µ ë§Œë“¤ê¸°
        - ğŸ¤ ë©˜í† Â·ì»¤ë®¤ë‹ˆí‹° ì—°ê²° ê³„íš
        - ğŸ” ë¶„ê¸°ë³„ ë¦¬ì…‹ ë°ì´ ìš´ì˜
        """)
    with st.expander("ğŸ¨ í¬íŠ¸í´ë¦¬ì˜¤ ì•„ì´ë””ì–´"):
        st.markdown("""
        - ğŸ“˜ íƒ€ì…ë³„ ì¼€ì´ìŠ¤ ìŠ¤í„°ë”” ì •ë¦¬
        - ğŸ“¹ 3ë¶„ ì…€í”„ í”¼ì¹˜ ì˜ìƒ
        - ğŸ—‚ ê³¼ì œâ†’í”„ë¡œì íŠ¸í™”(ê¹ƒí—ˆë¸Œ/ë…¸ì…˜)
        - ğŸ§ª í•´ì»¤í†¤Â·ê³µëª¨ì „ ì°¸ê°€ ê¸°ë¡
        """)

    st.info("âœ¨ ì‚¬ì´ë“œë°”ì—ì„œ ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ë©° ê³„ì† íƒìƒ‰í•´ ë³´ì„¸ìš”!")

# ===============================
# ğŸ Footer
# ===============================
st.markdown("""
<div class='subtle' style='text-align:center; margin-top:32px;'>
  Made with â¤ï¸ & Streamlit Â· MBTIëŠ” ìê¸°ì´í•´ ë„êµ¬ì¼ ë¿, ì ˆëŒ€ì  ê¸°ì¤€ì´ ì•„ë‹ˆì—ìš” ğŸ§¡
</div>
""", unsafe_allow_html=True)

